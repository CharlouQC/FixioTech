<html>
<head>
    <title>backend\controleurs\controleurHoraire.js</title>
    <style type="text/css" media="screen">
        #editor {
            position: absolute;
            top: 40px;
            right: 0;
            bottom: 0;
            left: 0;
        }
    </style>
</head>
<body style="font-family: 'DejaVu Sans', Arial, Helvetica, sans-serif">
<h3 style="margin-bottom: 0">backend\controleurs\controleurHoraire.js (<b>185</b> lines of code) (<a href="controleurHoraire.js">raw</a>):</h3>
<div id="editor">import { db } from &quot;../config/databaseConnexion.js&quot;;

const getHoraires = async (req, res, next) =&gt; {
  db.query(&quot;SELECT * FROM horaires&quot;, (err, results) =&gt; {
    if (err) {
      return next(err);
    }
    res.json(results);
  });
};

const getHoraireById = async (req, res, next) =&gt; {
  const { id } = req.params;
  db.query(&quot;SELECT * FROM horaires WHERE id = ?&quot;, [id], (err, results) =&gt; {
    if (err) {
      return next(err);
    }
    if (results.length === 0) {
      return res.status(404).json({ message: &quot;Horaire non trouv&eacute;&quot; });
    }
    res.json(results[0]);
  });
};

const addHoraire = async (req, res, next) =&gt; {
  const {
    employe_id,
    lundi_debut,
    lundi_fin,
    mardi_debut,
    mardi_fin,
    mercredi_debut,
    mercredi_fin,
    jeudi_debut,
    jeudi_fin,
    vendredi_debut,
    vendredi_fin,
    samedi_debut,
    samedi_fin,
    dimanche_debut,
    dimanche_fin,
  } = req.body;
  if (!employe_id) {
    return res.status(400).json({ message: &quot;Champs requis manquant&quot; });
  }

  db.query(
    &quot;INSERT INTO horaires (employe_id, lundi_debut, lundi_fin, mardi_debut, mardi_fin, mercredi_debut, mercredi_fin, jeudi_debut, jeudi_fin, vendredi_debut, vendredi_fin, samedi_debut, samedi_fin, dimanche_debut, dimanche_fin) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)&quot;,
    [
      employe_id,
      lundi_debut,
      lundi_fin,
      mardi_debut,
      mardi_fin,
      mercredi_debut,
      mercredi_fin,
      jeudi_debut,
      jeudi_fin,
      vendredi_debut,
      vendredi_fin,
      samedi_debut,
      samedi_fin,
      dimanche_debut,
      dimanche_fin,
    ],
    (err, results) =&gt; {
      if (err) {
        return next(err);
      }
      res.status(201).json({
        id: results.insertId,
        employe_id,
        lundi_debut,
        lundi_fin,
        mardi_debut,
        mardi_fin,
        mercredi_debut,
        mercredi_fin,
        jeudi_debut,
        jeudi_fin,
        vendredi_debut,
        vendredi_fin,
        samedi_debut,
        samedi_fin,
        dimanche_debut,
        dimanche_fin,
      });
    }
  );
};

const updateHoraire = async (req, res, next) =&gt; {
  const { id } = req.params;
  const {
    employe_id,
    lundi_debut,
    lundi_fin,
    mardi_debut,
    mardi_fin,
    mercredi_debut,
    mercredi_fin,
    jeudi_debut,
    jeudi_fin,
    vendredi_debut,
    vendredi_fin,
    samedi_debut,
    samedi_fin,
    dimanche_debut,
    dimanche_fin,
  } = req.body;

  db.query(
    &quot;UPDATE horaires SET employe_id = ?, lundi_debut = ?, lundi_fin = ?, mardi_debut = ?, mardi_fin = ?, mercredi_debut = ?, mercredi_fin = ?, jeudi_debut = ?, jeudi_fin = ?, vendredi_debut = ?, vendredi_fin = ?, samedi_debut = ?, samedi_fin = ?, dimanche_debut = ?, dimanche_fin = ? WHERE id = ?&quot;,
    [
      employe_id,
      lundi_debut,
      lundi_fin,
      mardi_debut,
      mardi_fin,
      mercredi_debut,
      mercredi_fin,
      jeudi_debut,
      jeudi_fin,
      vendredi_debut,
      vendredi_fin,
      samedi_debut,
      samedi_fin,
      dimanche_debut,
      dimanche_fin,
      id,
    ],
    (err, results) =&gt; {
      if (err) {
        return next(err);
      }
      if (results.affectedRows === 0) {
        return res.status(404).json({ message: &quot;Horaire non trouv&eacute;&quot; });
      }
      res.status(200).json({
        id,
        employe_id,
        lundi_debut,
        lundi_fin,
        mardi_debut,
        mardi_fin,
        mercredi_debut,
        mercredi_fin,
        jeudi_debut,
        jeudi_fin,
        vendredi_debut,
        vendredi_fin,
        samedi_debut,
        samedi_fin,
        dimanche_debut,
        dimanche_fin,
      });
    }
  );
};

const deleteHoraire = async (req, res, next) =&gt; {
  const { id } = req.params;

  db.query(&quot;DELETE FROM horaires WHERE id = ?&quot;, [id], (err, results) =&gt; {
    if (err) {
      return next(err);
    }
    if (results.affectedRows === 0) {
      return res.status(404).json({ message: &quot;Horaire non trouv&eacute;&quot; });
    }
    res.status(200).json({ message: &quot;Horaire supprim&eacute; avec succ&egrave;s&quot; });
  });
};

const getHoraireByEmployeId = async (req, res, next) =&gt; {
  const { employeId } = req.params;
  db.query(
    &quot;SELECT * FROM horaires WHERE employe_id = ?&quot;,
    [employeId],
    (err, results) =&gt; {
      if (err) return next(err);
      if (results.length === 0) return res.status(200).json(null);
      res.json(results[0]);
    }
  );
};

export {
  getHoraires,
  getHoraireById,
  addHoraire,
  updateHoraire,
  deleteHoraire,
  getHoraireByEmployeId,
};
</div>
<script src="https://www.zeljkoobrenovic.com/tools/common/lib/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    editor.session.setMode("ace/mode/javascript");
    editor.setTheme("ace/theme/xcode");
    editor.setReadOnly(true);
    editor.setOption("wrap", true);
    editor.setPrintMarginColumn(120);
</script>
</body>
