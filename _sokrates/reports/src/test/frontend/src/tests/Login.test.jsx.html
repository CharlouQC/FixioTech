<html>
<head>
    <title>frontend\src\tests\Login.test.jsx</title>
    <style type="text/css" media="screen">
        #editor {
            position: absolute;
            top: 40px;
            right: 0;
            bottom: 0;
            left: 0;
        }
    </style>
</head>
<body style="font-family: 'DejaVu Sans', Arial, Helvetica, sans-serif">
<h3 style="margin-bottom: 0">frontend\src\tests\Login.test.jsx (<b>87</b> lines of code) (<a href="Login.test.jsx">raw</a>):</h3>
<div id="editor">import { describe, it, expect, vi, beforeEach } from &quot;vitest&quot;;
import { render, screen, waitFor } from &quot;@testing-library/react&quot;;
import { MemoryRouter } from &quot;react-router-dom&quot;;
import userEvent from &quot;@testing-library/user-event&quot;;
import Login from &quot;../vues/login&quot;;

// Mock du hook useNavigate
const mockNavigate = vi.fn();

vi.mock(&quot;react-router-dom&quot;, async () =&gt; {
  const actual = await vi.importActual(&quot;react-router-dom&quot;);
  return {
    __esModule: true,
    ...actual,
    useNavigate: () =&gt; mockNavigate,
    Link: actual.Link,
    NavLink: actual.NavLink,
  };
});

describe(&quot;Login Component&quot;, () =&gt; {
  // R&eacute;initialise les mocks avant chaque test
  beforeEach(() =&gt; {
    mockNavigate.mockReset();
  });

  it(&quot;devrait rendre le formulaire de connexion&quot;, () =&gt; {
    render(
      &lt;MemoryRouter&gt;
        &lt;Login /&gt;
      &lt;/MemoryRouter&gt;
    );

    // V&eacute;rifie que les &eacute;l&eacute;ments essentiels sont pr&eacute;sents
    expect(screen.getByText(&quot;Connexion&quot;)).toBeInTheDocument();
    expect(screen.getByLabelText(&quot;Adresse courriel&quot;)).toBeInTheDocument();
    expect(screen.getByLabelText(&quot;Mot de passe&quot;)).toBeInTheDocument();
    expect(
      screen.getByRole(&quot;button&quot;, { name: &quot;Se connecter&quot; })
    ).toBeInTheDocument();
  });

  it(&quot;devrait afficher une erreur si les champs sont vides&quot;, async () =&gt; {
    render(
      &lt;MemoryRouter&gt;
        &lt;Login /&gt;
      &lt;/MemoryRouter&gt;
    );

    // Clique sur le bouton sans remplir les champs
    const submitButton = screen.getByRole(&quot;button&quot;, { name: &quot;Se connecter&quot; });
    await userEvent.click(submitButton);

    // V&eacute;rifie le message d'erreur
    expect(
      screen.getByText(&quot;Veuillez remplir tous les champs&quot;)
    ).toBeInTheDocument();
  });

  it(&quot;devrait permettre la saisie des donn&eacute;es&quot;, async () =&gt; {
    render(
      &lt;MemoryRouter&gt;
        &lt;Login /&gt;
      &lt;/MemoryRouter&gt;
    );

    // Simule la saisie des donn&eacute;es
    const emailInput = screen.getByLabelText(&quot;Adresse courriel&quot;);
    const passwordInput = screen.getByLabelText(&quot;Mot de passe&quot;);

    await userEvent.type(emailInput, &quot;test@example.com&quot;);
    await userEvent.type(passwordInput, &quot;password123&quot;);

    // V&eacute;rifie que les valeurs ont &eacute;t&eacute; saisies
    expect(emailInput.value).toBe(&quot;test@example.com&quot;);
    expect(passwordInput.value).toBe(&quot;password123&quot;);
  });

  it(&quot;devrait rediriger vers la page d'accueil apr&egrave;s une connexion r&eacute;ussie&quot;, async () =&gt; {
    render(
      &lt;MemoryRouter&gt;
        &lt;Login /&gt;
      &lt;/MemoryRouter&gt;
    );

    // Simule une connexion r&eacute;ussie
    const emailInput = screen.getByLabelText(&quot;Adresse courriel&quot;);
    const passwordInput = screen.getByLabelText(&quot;Mot de passe&quot;);
    const submitButton = screen.getByRole(&quot;button&quot;, { name: &quot;Se connecter&quot; });

    await userEvent.type(emailInput, &quot;test@example.com&quot;);
    await userEvent.type(passwordInput, &quot;password123&quot;);
    await userEvent.click(submitButton);

    // V&eacute;rifie que le bouton affiche &quot;Connexion en cours...&quot;
    expect(submitButton).toBeDisabled();
    expect(screen.getByText(&quot;Connexion en cours...&quot;)).toBeInTheDocument();

    // Attend la redirection
    await waitFor(() =&gt; {
      expect(mockNavigate).toHaveBeenCalledWith(&quot;/&quot;);
    });
  });
});
</div>
<script src="https://www.zeljkoobrenovic.com/tools/common/lib/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    editor.session.setMode("ace/mode/html");
    editor.setTheme("ace/theme/xcode");
    editor.setReadOnly(true);
    editor.setOption("wrap", true);
    editor.setPrintMarginColumn(120);
</script>
</body>
